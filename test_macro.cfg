[gcode_macro GETTEMP]
gcode:
     {% set CUR_TEMP = printer.extruder.temperature %}
     {% set TARGET_TEMP = printer.extruder.target %}
    { action_respond_info("Current temp: %.2f  Target temp: %.2f" % (CUR_TEMP, TARGET_TEMP)) }


[gcode_macro TEST1]
gcode:
    { action_respond_info("x_offset: %.2f" % printer['configfile'].config["probe"]["x_offset"]|float) }
[gcode_macro TEST2]
gcode:
    {% set val = params.VAL %}
    {action_respond_info("Val %s" % val)}
    {action_respond_info(("True %s" % val) if val is sameas True else ("False %s" % val))}

[gcode_macro TEST3]
gcode:
#    { action_respond_info("x_offset: %.2f" % printer.configfile.settings.bed_mesh.mesh_min[0]|float) }
#    { action_respond_info("x_offset: %.2f" % printer.configfile.settings.bed_mesh.mesh_min[1]|float) }
#    { action_respond_info("x_offset: %.2f" % printer.configfile.settings.bed_mesh.mesh_max[0]|float) }
#    { action_respond_info("x_offset: %.2f" % printer.configfile.settings.bed_mesh.mesh_max[1]|float) }

    {% set MINX = params.MINX|default(printer.configfile.settings.bed_mesh.mesh_min[0])|float %}
    {% set MINY = params.MINY|default(printer.configfile.settings.bed_mesh.mesh_min[1])|float %}    
    {% set MAXX = params.MAXX|default(printer.configfile.settings.bed_mesh.mesh_max[0])|float %}
    {% set MAXY = params.MAXY|default(printer.configfile.settings.bed_mesh.mesh_max[1])|float %}

    {action_respond_info( "In: MINX %.2f, MINY %.2f, MAXX %.2f, MAXY %.2f\n" % ( MINX, MINY, MAXX, MAXY) )}

    {% set MINX = (MINX if MINX|float > printer.configfile.settings.bed_mesh.mesh_min[0]|float else printer.configfile.settings.bed_mesh.mesh_min[0])|float %}
    {% set MINY = (MINY if MINY|float > printer.configfile.settings.bed_mesh.mesh_min[1]|float else printer.configfile.settings.bed_mesh.mesh_min[1])|float %}
    {% set MAXX = (MAXX if MAXX|float < printer.configfile.settings.bed_mesh.mesh_max[0]|float else printer.configfile.settings.bed_mesh.mesh_max[0])|float %}
    {% set MAXY = (MAXY if MAXY|float < printer.configfile.settings.bed_mesh.mesh_max[1]|float else printer.configfile.settings.bed_mesh.mesh_max[1])|float %}

#    {% set MINY = params.MINY|default(35)|int %}    
#    {% set MAXX = params.MAXX|default(315)|int %}
#    {% set MAXY = params.MAXY|default(315)|int %}

    {action_respond_info( "Out: MINX %.2f, MINY %.2f, MAXX %.2f, MAXY %.2f\n" % ( MINX, MINY, MAXX, MAXY) )}


#    {% if printer['firmware_retraction'].retract_length > 0 %}
#       {% set save_params = {'retract'           : printer['firmware_retraction'].retract_length|default(0)|float|round(2),
#                             'pressure_advance'  : printer['extruder'].pressure_advance|default(0)|float|round(3)} %}
#       { action_respond_info("Saved retract: %.2f pressure_advance: %.3f" % (save_params.retract, save_params.pressure_advance)) }
#    {% else %}
#       { action_respond_info("Retract and pressure_advance not stored as they are zero value.") }
#    {% endif %}

[gcode_macro print_end2]
gcode:
 G91        #relative positioning
 G0 E-0.3 F4800     #retract 0.3mm of filament
 G0 Z+1.00 X-2 Y-2 F6000   #short quick move to disengage from print
 G0 Z+5.00  F12000     #move Z-Axis 5mm away from part
 #G0 E-1.0 F4000               #retract 1mm of filament to move it out of melt zone

    G0 E3 F5400           # blob a bit
    G0 E-3 F5400          # forming filament Tip for Rapido -> from ERCF V3 ercf_software.cfg 
    G0 E2 F600
    G0 E-2.1 F600
    G0 E2 F600
    G0 E-2.2 F600
    G0 E2 F600
    G0 E-2.3 F600
    G0 E2 F600
    G0 E-2.4 F600
    G0 E2 F600
    G0 E-2.5 F600
    G0 E-6 F600

 